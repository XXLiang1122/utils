var a=Object.assign;import{_ as e}from"./Wrapper.30c6c947.js";import{d as n,r as t,l,q as s,t as r,s as i,p as g,a as o,b as u,o as d,c as h,w as c,e as p,f as m,v,i as C,u as f}from"./index.81a38c2f.js";var b=(a,e)=>{const{data:n}=a,t=n.length;let l=0,s=0,r=0,i=0;for(let g=0;g<t;g+=4)l=+e.r+n[g],s=+e.g+n[g+1],r=+e.b+n[g+2],i=+e.a+n[g+3],n[g]=l<0?0:l>255?255:l,n[g+1]=s<0?0:s>255?255:s,n[g+2]=r<0?0:r>255?255:r,n[g+3]=i<0?0:i>255?255:i;return a},w=(a,e)=>{const{data:n}=a,t=n.length;let l=0,s=0,r=0;for(let i=0;i<t;i+=4){let[a,t,g]=I(n[i],n[i+1],n[i+2]);0===i&&console.log(a,t,g),a=+e.h+a/100,t=+e.s+t/100,g=+e.l+g/100,l=a<0?0:a>1?1:a,s=t<0?0:t>1?1:t,r=g<0?0:g>1?1:g;let[o,u,d]=U(l,s,r);n[i]=o,n[i+1]=u,n[i+2]=d}return a};function I(a,e,n){let t=a/255,l=e/255,s=n/255,r=Math.max(t,l,s),i=Math.min(t,l,s),g=(r+i)/2,o=(r+i)/2,u=(r+i)/2;if(r===i)g=0,o=0;else{let a=r-i;switch(o=u>.5?a/(2-r-i):a/(r+i),r){case t:g=(l-s)/a+(l<s?6:0);break;case l:g=(s-t)/a+2;break;case s:g=(t-l)/a+4}g/=6}return[Math.floor(100*g),Math.round(100*o),Math.round(100*u)]}function U(a,e,n){let t,l,s;if(0===e)t=n,l=n,s=n;else{const r=(a,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?a+6*(e-a)*n:n<.5?e:n<2/3?a+(e-a)*(2/3-n)*6:a),i=n<.5?n*(1+e):n+e-n*e,g=2*n-i;t=r(g,i,a+1/3),l=r(g,i,a),s=r(g,i,a-1/3)}return[Math.round(255*t),Math.round(255*l),Math.round(255*s)]}var y=n({name:"Filter",components:{Wrapper:e},setup:()=>{const e=t({r:0,g:0,b:0,a:0}),n=t({h:0,s:0,l:0}),g=t({width:600,height:480}),o={startMove:!1,startX:0,startY:0},u={width:0,height:0,originImgData:{}},d=t({imageUrl:"",imageName:"img",mineType:"image/png",scale:1}),h=l(),c=l();let p;const m=()=>new ImageData(new Uint8ClampedArray(u.originImgData.data),u.originImgData.width,u.originImgData.height),v=()=>{const a=new Image;a.onload=()=>{a.naturalWidth>1e4||a.naturalHeight>1e4?alert("图片太大了！"):(g.width=a.naturalWidth,g.height=a.naturalHeight,u.width=a.naturalWidth,u.height=a.naturalHeight,i((()=>{null==p||p.drawImage(a,0,0,u.width,u.height),u.originImgData=(null==p?void 0:p.getImageData(0,0,u.width,u.height))||{},C()})))},a.src=d.imageUrl},C=()=>{var a;d.scale=1,e.r=0,e.g=0,e.b=0,e.a=0,n.h=0,n.s=0,n.l=0,null==(a=c.value)||a.scrollTo(4500,4600)};return s((()=>{p=h.value.getContext("2d"),C()})),a(a(a(a({},r(e)),r(n)),r(d)),{canvas:g,refCanvas:h,refCanvasContainer:c,rgbaChange:()=>{if(!d.imageUrl)return;const{h:a,s:t,l:l}=n;let s=m();(+a||+t||+l)&&(s=w(s,n)),s=b(s,e),null==p||p.putImageData(s,0,0)},hslChange:()=>{if(!d.imageUrl)return;const{r:a,g:t,b:l,a:s}=e;let r=m();(+a||+t||+l||+s)&&(r=b(r,e)),r=w(r,n),null==p||p.putImageData(r,0,0)},imageChange:a=>{const e=a.target.files||[];if(0===e.length)return;const n=new FileReader;n.readAsDataURL(e[0]),n.onload=a=>{var e;d.imageUrl=null==(e=a.target)?void 0:e.result,v()},d.imageName=e[0].name,d.mineType=e[0].type},dragStart:a=>{o.startMove=!0,o.startX=a.screenX,o.startY=a.screenY},dragOver:a=>{var e;o.startMove&&(a.screenX===o.startX&&a.screenY===o.startY||(null==(e=c.value)||e.scrollBy(1*(o.startX-a.screenX),1*(o.startY-a.screenY)),o.startX=a.screenX,o.startY=a.screenY))},dragEnd:a=>{o.startMove=!1},downloadImage:()=>{const a=h.value.toDataURL(d.mineType),e=document.createElement("a");e.href=a,e.download=d.imageName,e.click()},resetStatus:()=>{d.imageUrl&&(null==p||p.putImageData(m(),0,0),C())}})}});const M=c("data-v-57bc5fee");g("data-v-57bc5fee");const x={class:"btn-group"},D=p("label",{class:"btn-upload button-l",for:"file"},"选择图片",-1),X={class:"contols-group"},Y={class:"controls"},V=p("span",null,"R 红色 ",-1),S={class:"value"},k=p("span",null,"G 绿色 ",-1),W={class:"value"},E=p("span",null,"B 蓝色 ",-1),H={class:"value"},O=p("span",null,"A 透明 ",-1),R={class:"value"},T={class:"controls"},_=p("span",null,"H 色相 ",-1),j={class:"value"},A=p("span",null,"S 饱和 ",-1),L={class:"value"},N=p("span",null,"L 亮度 ",-1),B={class:"value"},F={class:"board"},$={class:"right"},q={class:"scale-control"};o();const G=M(((a,e,n,t,l,s)=>{const r=u("Wrapper");return d(),h(r,{title:"图片处理",width:"1200"},{default:M((()=>[p("div",x,[D,p("input",{id:"file",type:"file",accept:"image/*",onChange:e[1]||(e[1]=(...e)=>a.imageChange&&a.imageChange(...e))},null,32),p("div",{class:"button-l",onClick:e[2]||(e[2]=(...e)=>a.downloadImage&&a.downloadImage(...e))},"下载图片"),p("div",{class:"button-l",onClick:e[3]||(e[3]=(...e)=>a.resetStatus&&a.resetStatus(...e))},"重置")]),p("div",X,[p("div",Y,[p("div",null,[V,m(p("input",{"onUpdate:modelValue":e[4]||(e[4]=e=>a.r=e),type:"range",min:"-255",max:"255",onChange:e[5]||(e[5]=(...e)=>a.rgbaChange&&a.rgbaChange(...e))},null,544),[[v,a.r]]),p("span",S,C(a.r),1)]),p("div",null,[k,m(p("input",{"onUpdate:modelValue":e[6]||(e[6]=e=>a.g=e),type:"range",min:"-255",max:"255",onChange:e[7]||(e[7]=(...e)=>a.rgbaChange&&a.rgbaChange(...e))},null,544),[[v,a.g]]),p("span",W,C(a.g),1)]),p("div",null,[E,m(p("input",{"onUpdate:modelValue":e[8]||(e[8]=e=>a.b=e),type:"range",min:"-255",max:"255",onChange:e[9]||(e[9]=(...e)=>a.rgbaChange&&a.rgbaChange(...e))},null,544),[[v,a.b]]),p("span",H,C(a.b),1)]),p("div",null,[O,m(p("input",{"onUpdate:modelValue":e[10]||(e[10]=e=>a.a=e),type:"range",min:"-255",max:"255",onChange:e[11]||(e[11]=(...e)=>a.rgbaChange&&a.rgbaChange(...e))},null,544),[[v,a.a]]),p("span",R,C(a.a),1)])]),p("div",T,[p("div",null,[_,m(p("input",{"onUpdate:modelValue":e[12]||(e[12]=e=>a.h=e),type:"range",min:"-1",max:"1",step:"0.01",onChange:e[13]||(e[13]=(...e)=>a.hslChange&&a.hslChange(...e))},null,544),[[v,a.h]]),p("span",j,C(parseInt(100*a.h))+"%",1)]),p("div",null,[A,m(p("input",{"onUpdate:modelValue":e[14]||(e[14]=e=>a.s=e),type:"range",min:"-1",max:"1",step:"0.01",onChange:e[15]||(e[15]=(...e)=>a.hslChange&&a.hslChange(...e))},null,544),[[v,a.s]]),p("span",L,C(parseInt(100*a.s))+"%",1)]),p("div",null,[N,m(p("input",{"onUpdate:modelValue":e[16]||(e[16]=e=>a.l=e),type:"range",min:"-1",max:"1",step:"0.01",onChange:e[17]||(e[17]=(...e)=>a.hslChange&&a.hslChange(...e))},null,544),[[v,a.l]]),p("span",B,C(parseInt(100*a.l))+"%",1)])])]),p("div",F,[p("div",{class:"preview",ref:"refCanvasContainer",onMousewheel:e[21]||(e[21]=f((()=>{}),["prevent"]))},[p("div",{class:"canvas",style:{transform:`scale(${a.scale})`},onMousedown:e[18]||(e[18]=(...e)=>a.dragStart&&a.dragStart(...e)),onMousemove:e[19]||(e[19]=(...e)=>a.dragOver&&a.dragOver(...e)),onMouseup:e[20]||(e[20]=(...e)=>a.dragEnd&&a.dragEnd(...e))},[p("canvas",{ref:"refCanvas",width:a.canvas.width,height:a.canvas.height},null,8,["width","height"])],36)],544),p("div",$,[p("div",{class:"origin",style:{"background-image":`url(${a.imageUrl})`}},null,4),p("div",q,[p("span",null,C(parseInt(100*a.scale))+"%",1),m(p("input",{"onUpdate:modelValue":e[22]||(e[22]=e=>a.scale=e),type:"range",min:"0.1",max:"1.9",step:"0.01"},null,512),[[v,a.scale]])])])])])),_:1})}));y.render=G,y.__scopeId="data-v-57bc5fee";export default y;
